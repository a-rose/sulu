<dom-module id="element-core-data-view">
	<template> 
		<span class="element-core-data-view-path">
			<template is="dom-repeat" items="{{xpath}}">
			   <a on-click="cwd" data-path$="{{item.path}}" class="element-core-data-view-path-item" href="" class="element-core-data-view-path-item"> 
			   		<span class="element-core-data-view-path-item">[[item.folder]]</span><span class="element-core-data-view-path-item">[[sep]]</span>
			   </a>
			</template>
		</span>


		<div class="clusterize">
			<div class="horizontal layout">
				<div class="flex-1">
				</div>
				<div class="flex-7">
					name
				</div>
				<div class="flex-1">
					ext
				</div>
				<div class="flex-1">
					size
				</div>
				<div class="flex-1">
					attr
				</div>
			</div>
			<div id="{{scrollAreaID}}" class="clusterize-scroll">
				<div id="{{contentAreaID}}" class="clusterize-content">
					<div class="clusterize-no-data">
						<i>{{loadingMessage}}</i>
					</div>
				</div>
			</div>
		</div>
	</template>

	<script> 

		window.Polymer({
			is: "element-core-data-view",
				ready: function() {
					var self = this;
					this.loadingMessage = "Loading data...";
					var id = this.getAttribute("view-id");
					this.scrollAreaID = "scrollArea" + id;
					this.contentAreaID = "contentArea" + id;

					var fileSystemView = new FileSystemView(id);
					this.sep = require("path").sep;
					this.path = fileSystemView.path.split(this.sep);
					fileSystemView.el = this;

					this.xpath = [];
					for(var i = 0; i < this.path.length; i++){ 
						this.push("xpath", {
							folder : this.path[i],
							path : this.path.slice(0, i + 1).join(this.sep) 
						});
					} 

					self.cwd = fileSystemView.pathLinkClick.bind(fileSystemView);

					$(function() {
						fileSystemView.bind(); 
						$( self ).
							data("controller", fileSystemView).
							on( "dblclick", ".filesystemitem", {}, fileSystemView.dblclick).
							on( "click", ".filesystemitem", {}, fileSystemView.click)
							//on( "click", ".element-core-data-view-path-link", {}, fileSystemView.pathLinkClick)
							;
						window.resizeScrollViews();
					});
 
				}
			}
		);
	</script>
</dom-module>